<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Day15 è¯æ±‡åŠ è½½æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 900px;
            margin: 40px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h2 {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            font-weight: bold;
        }
        .success {
            background: #d4edda;
            color: #155724;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
        }
        .word-item {
            padding: 8px;
            margin: 5px 0;
            background: #f8f9fa;
            border-left: 3px solid #3498db;
            display: flex;
            justify-content: space-between;
        }
        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background: #2980b9;
        }
        #configInfo, #loadedLibraries, #words {
            font-family: monospace;
            font-size: 14px;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <h1>ğŸ”§ Day15 è¯æ±‡åŠ è½½é—®é¢˜ä¿®å¤æµ‹è¯•</h1>
    
    <div class="test-section">
        <h2>é—®é¢˜åˆ†æ</h2>
        <div class="info status">
            <strong>é—®é¢˜åŸå› ï¼š</strong> é»˜è®¤é…ç½®åªåŠ è½½å‰4å¤©è¯¾ç¨‹ (day01-day04)ï¼Œday15æ²¡æœ‰è¢«åŒ…å«åœ¨å†…
        </div>
        <div class="success status">
            <strong>ä¿®å¤æ–¹æ¡ˆï¼š</strong> ä¿®æ”¹é…ç½®åŠ è½½å™¨ï¼Œé»˜è®¤åŠ è½½æ‰€æœ‰15å¤©çš„daily-phonicsè¯¾ç¨‹
        </div>
    </div>

    <div class="test-section">
        <h2>1. é…ç½®åŠ è½½æµ‹è¯•</h2>
        <button onclick="testConfigLoader()">æµ‹è¯•é…ç½®åŠ è½½å™¨</button>
        <div id="configStatus"></div>
        <pre id="configInfo"></pre>
    </div>

    <div class="test-section">
        <h2>2. è¯æ±‡ç®¡ç†å™¨æµ‹è¯•</h2>
        <button onclick="testVocabManager()">æµ‹è¯•è¯æ±‡ç®¡ç†å™¨</button>
        <div id="vocabStatus"></div>
        <pre id="loadedLibraries"></pre>
    </div>

    <div class="test-section">
        <h2>3. Day15å•è¯åŠ è½½æµ‹è¯•</h2>
        <button onclick="testDay15Words()">åŠ è½½Day15å•è¯</button>
        <div id="day15Status"></div>
        <div id="words"></div>
    </div>

    <div class="test-section">
        <h2>4. éšæœºå•è¯ç”Ÿæˆæµ‹è¯•</h2>
        <button onclick="testRandomWords()">ç”Ÿæˆ10ä¸ªéšæœºå•è¯</button>
        <div id="randomStatus"></div>
        <div id="randomWords"></div>
    </div>

    <!-- æ·»åŠ æ—¶é—´æˆ³é¿å…ç¼“å­˜ -->
    <script src="vocabulary-config-loader.js?v=20251006-fix2"></script>
    <script src="vocabulary-manager-v2.js?v=20251006-fix2"></script>
    
    <script>
        let configLoader;
        let vocabManager;

        async function testConfigLoader() {
            const statusDiv = document.getElementById('configStatus');
            const infoDiv = document.getElementById('configInfo');
            
            try {
                statusDiv.innerHTML = '<div class="info status">â³ æ­£åœ¨åŠ è½½é…ç½®...</div>';
                
                configLoader = new VocabularyConfigLoader();
                const config = await configLoader.loadConfig();
                
                statusDiv.innerHTML = '<div class="success status">âœ… é…ç½®åŠ è½½æˆåŠŸï¼</div>';
                
                const dailyPhonics = config.categories.find(c => c.id === 'daily-phonics');
                const enabledLibs = config.defaultConfig.enabledLibraries;
                const hasDay15 = enabledLibs.includes('day15');
                
                infoDiv.textContent = `é…ç½®ä¿¡æ¯ï¼š
- Daily Phonicsè¯¾ç¨‹æ•°: ${dailyPhonics.subcategories.length}
- é»˜è®¤å¯ç”¨è¯¾ç¨‹æ•°: ${enabledLibs.length}
- æ˜¯å¦åŒ…å«Day15: ${hasDay15 ? 'âœ… æ˜¯' : 'âŒ å¦'}
- å¯ç”¨çš„è¯¾ç¨‹: ${enabledLibs.join(', ')}

Day15é…ç½®:
${JSON.stringify(dailyPhonics.subcategories.find(s => s.id === 'day15'), null, 2)}`;
                
                if (!hasDay15) {
                    statusDiv.innerHTML += '<div class="error status">âŒ è­¦å‘Šï¼šDay15æœªåŒ…å«åœ¨é»˜è®¤é…ç½®ä¸­ï¼</div>';
                }
                
            } catch (error) {
                statusDiv.innerHTML = '<div class="error status">âŒ é…ç½®åŠ è½½å¤±è´¥: ' + error.message + '</div>';
                console.error(error);
            }
        }

        async function testVocabManager() {
            const statusDiv = document.getElementById('vocabStatus');
            const libDiv = document.getElementById('loadedLibraries');
            
            try {
                statusDiv.innerHTML = '<div class="info status">â³ æ­£åœ¨åˆå§‹åŒ–è¯æ±‡ç®¡ç†å™¨...</div>';
                
                vocabManager = new VocabularyManagerV2();
                
                // ç­‰å¾…åŠ è½½å®Œæˆ
                await new Promise(resolve => {
                    const checkLoaded = setInterval(() => {
                        if (vocabManager.isLoaded) {
                            clearInterval(checkLoaded);
                            resolve();
                        }
                    }, 100);
                });
                
                statusDiv.innerHTML = '<div class="success status">âœ… è¯æ±‡ç®¡ç†å™¨åˆå§‹åŒ–æˆåŠŸï¼</div>';
                
                const stats = vocabManager.getLibraryStats();
                const config = vocabManager.getCurrentConfig();
                const hasDay15 = vocabManager.loadedLibraries.has('day15');
                
                libDiv.textContent = `è¯æ±‡ç®¡ç†å™¨çŠ¶æ€ï¼š
- å·²åŠ è½½è¯åº“æ•°: ${stats.totalLibraries}
- æ€»å•è¯æ•°: ${stats.totalWords}
- æ˜¯å¦åŠ è½½Day15: ${hasDay15 ? 'âœ… æ˜¯' : 'âŒ å¦'}
- å¯ç”¨çš„è¯åº“: ${config.enabledLibraries.join(', ')}

å·²åŠ è½½çš„è¯åº“:
${stats.libraries.map(lib => `  - ${lib.id}: ${lib.name} (${lib.wordCount}è¯)`).join('\n')}`;
                
                if (!hasDay15) {
                    statusDiv.innerHTML += '<div class="error status">âŒ è­¦å‘Šï¼šDay15æœªåŠ è½½ï¼</div>';
                }
                
            } catch (error) {
                statusDiv.innerHTML = '<div class="error status">âŒ è¯æ±‡ç®¡ç†å™¨åˆå§‹åŒ–å¤±è´¥: ' + error.message + '</div>';
                console.error(error);
            }
        }

        async function testDay15Words() {
            const statusDiv = document.getElementById('day15Status');
            const wordsDiv = document.getElementById('words');
            
            try {
                statusDiv.innerHTML = '<div class="info status">â³ æ­£åœ¨åŠ è½½Day15å•è¯...</div>';
                
                const response = await fetch('./words/daily-phonics/day15.json');
                if (!response.ok) {
                    throw new Error('Day15æ–‡ä»¶ä¸å­˜åœ¨æˆ–æ— æ³•è®¿é—®');
                }
                
                const data = await response.json();
                
                statusDiv.innerHTML = '<div class="success status">âœ… Day15å•è¯åŠ è½½æˆåŠŸï¼</div>';
                
                wordsDiv.innerHTML = `
<strong>Day15 - ${data.metadata.name}</strong>
<p>éŸ³æ ‡: ${data.metadata.phoneme} | éš¾åº¦: ${data.metadata.difficulty} | å•è¯æ•°: ${data.metadata.wordCount}</p>
<div>
    ${data.words.map((w, i) => `
        <div class="word-item">
            <span>${i + 1}. ${w.word}</span>
            <span>${w.phonetic}</span>
            <span>${w.meaning}</span>
            <span>éš¾åº¦${w.difficulty}</span>
        </div>
    `).join('')}
</div>
                `;
                
            } catch (error) {
                statusDiv.innerHTML = '<div class="error status">âŒ Day15å•è¯åŠ è½½å¤±è´¥: ' + error.message + '</div>';
                console.error(error);
            }
        }

        async function testRandomWords() {
            const statusDiv = document.getElementById('randomStatus');
            const wordsDiv = document.getElementById('randomWords');
            
            if (!vocabManager || !vocabManager.isLoaded) {
                statusDiv.innerHTML = '<div class="error status">âŒ è¯·å…ˆè¿è¡Œ"æµ‹è¯•è¯æ±‡ç®¡ç†å™¨"</div>';
                return;
            }
            
            try {
                statusDiv.innerHTML = '<div class="info status">â³ æ­£åœ¨ç”Ÿæˆéšæœºå•è¯...</div>';
                
                const randomWords = [];
                for (let i = 0; i < 10; i++) {
                    const difficulty = (i % 3) + 1;
                    const word = vocabManager.getRandomWord(difficulty);
                    if (word) {
                        randomWords.push(word);
                    }
                }
                
                if (randomWords.length === 0) {
                    throw new Error('æ— æ³•ç”Ÿæˆéšæœºå•è¯');
                }
                
                statusDiv.innerHTML = '<div class="success status">âœ… éšæœºå•è¯ç”ŸæˆæˆåŠŸï¼</div>';
                
                wordsDiv.innerHTML = randomWords.map((w, i) => `
                    <div class="word-item">
                        <span>${i + 1}. ${w.original}</span>
                        <span>${w.phonetic}</span>
                        <span>${w.meaning}</span>
                        <span>éš¾åº¦${w.difficulty}</span>
                        <span>æ˜¾ç¤º: ${w.display}</span>
                    </div>
                `).join('');
                
            } catch (error) {
                statusDiv.innerHTML = '<div class="error status">âŒ éšæœºå•è¯ç”Ÿæˆå¤±è´¥: ' + error.message + '</div>';
                console.error(error);
            }
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¿è¡ŒåŸºæœ¬æµ‹è¯•
        window.addEventListener('load', () => {
            console.log('=== Day15 è¯æ±‡åŠ è½½é—®é¢˜ä¿®å¤æµ‹è¯• ===');
            setTimeout(() => {
                testConfigLoader();
                setTimeout(() => {
                    testVocabManager();
                }, 1000);
            }, 500);
        });
    </script>
</body>
</html>

