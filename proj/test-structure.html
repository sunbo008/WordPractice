<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç»“æ„æµ‹è¯• - Word Tetris</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
        }

        .test-result {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #ffd700;
        }

        .test-result.success {
            border-left-color: #4CAF50;
        }

        .test-result.error {
            border-left-color: #f44336;
        }

        .test-result h3 {
            margin: 0 0 10px 0;
            color: #ffd700;
        }

        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px 5px;
        }

        button:hover {
            background: #45a049;
        }
    </style>
</head>

<body>
    <h1>ğŸ§ª Word Tetris ç»“æ„æµ‹è¯•</h1>

    <div class="test-result">
        <h3>æµ‹è¯•è¯´æ˜</h3>
        <p>æ­¤é¡µé¢ç”¨äºéªŒè¯æ–°çš„ç›®å½•ç»“æ„æ˜¯å¦æ­£ç¡®é…ç½®</p>
    </div>

    <button onclick="runTests()">è¿è¡Œæ‰€æœ‰æµ‹è¯•</button>
    <button onclick="window.location.href='index.html'">è¿›å…¥æ¸¸æˆ</button>
    <button onclick="window.location.href='tests/tts-service-test.html'" style="background: #9C27B0;">ğŸ¤ TTS
        æœåŠ¡æµ‹è¯•</button>
    <button onclick="window.location.href='tests/ios-compatibility-test.html'" style="background: #FF9800;">ğŸ iOS
        å…¼å®¹æ€§æµ‹è¯•</button>
    <button onclick="window.location.href='tests/test-loading-performance.html'" style="background: #667eea;">âš¡
        åŠ è½½æ€§èƒ½æµ‹è¯•</button>
    <button onclick="window.location.href='tools/diagnose-missed-words.html'" style="background: #e74c3c;">ğŸ”
        é”™è¯å¡è¯Šæ–­å·¥å…·</button>

    <div id="results"></div>

    <script>
        async function runTests() {
            const results = document.getElementById('results');
            results.innerHTML = '<h2>æµ‹è¯•ç»“æœï¼š</h2>';

            // æµ‹è¯•1: CSSæ–‡ä»¶
            addResult('æµ‹è¯• CSS æ–‡ä»¶åŠ è½½', await testFile('css/styles.css'));
            addResult('æµ‹è¯•è®¾ç½® CSS æ–‡ä»¶åŠ è½½', await testFile('css/settings.css'));

            // æµ‹è¯•2: æ ¸å¿ƒJSæ–‡ä»¶
            addResult('æµ‹è¯• WordTetrisGame.js', await testFile('../src/core/WordTetrisGame.js'));
            addResult('æµ‹è¯• vocabulary-manager-v2.js', await testFile('../src/core/vocabulary-manager-v2.js'));
            addResult('æµ‹è¯• vocabulary-config-loader.js', await testFile('../src/core/vocabulary-config-loader.js'));

            // æµ‹è¯•3: å·¥å…·ç±»
            addResult('æµ‹è¯• DebugLogger-standalone.js', await testFile('../src/utils/DebugLogger-standalone.js'));
            addResult('æµ‹è¯• TTSService.js', await testFile('../src/utils/TTSService.js'));
            addResult('æµ‹è¯• SpeechSystem.js', await testFile('../src/systems/SpeechSystem.js'));
            addResult('æµ‹è¯• CanvasHelper.js', await testFile('../src/utils/CanvasHelper.js'));

            // æµ‹è¯•4: è¯åº“æ–‡ä»¶
            addResult('æµ‹è¯• words ç›®å½•è®¿é—®', await testFile('words/config.json'));
            addResult('æµ‹è¯• day01.json', await testFile('words/daily-phonics/day01.json'));

            // æµ‹è¯•5: å›¾ç‰‡ç›®å½•
            addResult('æµ‹è¯• images ç›®å½•è®¿é—®', await testDirectory('images/cache/'));

            // æµ‹è¯•6: æµ‹è¯•é¡µé¢
            addResult('æµ‹è¯• TTS æµ‹è¯•é¡µé¢', await testFile('tests/tts-service-test.html'));
            addResult('æµ‹è¯• iOS å…¼å®¹æ€§æµ‹è¯•é¡µé¢', await testFile('tests/ios-compatibility-test.html'));
            addResult('æµ‹è¯•åŠ è½½æ€§èƒ½æµ‹è¯•é¡µé¢', await testFile('tests/test-loading-performance.html'));

            // æœ€ç»ˆæ€»ç»“
            const allTests = document.querySelectorAll('.test-result');
            const successCount = document.querySelectorAll('.test-result.success').length;
            const totalCount = allTests.length - 1; // å‡å»è¯´æ˜

            const summary = document.createElement('div');
            summary.className = successCount === totalCount ? 'test-result success' : 'test-result error';
            summary.innerHTML = `
                <h3>æµ‹è¯•æ€»ç»“</h3>
                <p>é€šè¿‡: ${successCount} / ${totalCount}</p>
                ${successCount === totalCount ?
                    '<p>âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼æ–°ç›®å½•ç»“æ„é…ç½®æ­£ç¡®ã€‚</p>' :
                    '<p>âŒ éƒ¨åˆ†æµ‹è¯•å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶è·¯å¾„å’ŒJunctioné“¾æ¥ã€‚</p>'
                }
            `;
            results.appendChild(summary);
        }

        async function testFile(path) {
            try {
                const response = await fetch(path);
                return response.ok;
            } catch (e) {
                return false;
            }
        }

        async function testDirectory(path) {
            // ç®€å•æµ‹è¯•ï¼šå°è¯•è®¿é—®ç›®å½•ï¼ˆè™½ç„¶å¯èƒ½403ï¼Œä½†ä¸æ˜¯404å°±è¯´æ˜å­˜åœ¨ï¼‰
            try {
                const response = await fetch(path);
                return response.status !== 404;
            } catch (e) {
                return false;
            }
        }

        function addResult(name, success) {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = `test-result ${success ? 'success' : 'error'}`;
            div.innerHTML = `
                <h3>${success ? 'âœ…' : 'âŒ'} ${name}</h3>
                <p>${success ? 'æˆåŠŸ' : 'å¤±è´¥'}</p>
            `;
            results.appendChild(div);
        }
    </script>
</body>

</html>