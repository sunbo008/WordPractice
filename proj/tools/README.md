# ğŸ› ï¸ Word Tetris ä¼˜åŒ–å·¥å…·

## ğŸ“‹ å¿«é€Ÿå¼€å§‹

### 1ï¸âƒ£ å®‰è£…ä¾èµ–

```bash
cd proj/tools
npm install
```

è¿™ä¼šå®‰è£…ï¼š
- `fluent-ffmpeg` + `ffmpeg-static`ï¼ˆéŸ³é¢‘å‹ç¼©ï¼‰
- `sharp`ï¼ˆå›¾ç‰‡å‹ç¼©ï¼‰

### 2ï¸âƒ£ è¿è¡Œå‹ç¼©

```bash
# å‹ç¼©éŸ³é¢‘ï¼ˆ662 ä¸ª MP3 æ–‡ä»¶ï¼‰
npm run compress:audio

# å‹ç¼©å›¾ç‰‡ï¼ˆ608 ä¸ª JPG/JPEG æ–‡ä»¶ï¼‰
npm run compress:images

# ä¸€é”®å‹ç¼©æ‰€æœ‰èµ„æº
npm run compress:all
```

### 3ï¸âƒ£ æŸ¥çœ‹ç»“æœ

- éŸ³é¢‘è¾“å‡ºï¼š`proj/audio-optimized/`
- å›¾ç‰‡è¾“å‡ºï¼š`proj/images-optimized/`

---

## ğŸ“Š é¢„æœŸæ•ˆæœ

| èµ„æºç±»å‹ | åŸå§‹å¤§å° | å‹ç¼©å | èŠ‚çœ |
|---------|---------|--------|------|
| éŸ³é¢‘ | ~35 MB | ~8 MB | **77%** â¬‡ï¸ |
| å›¾ç‰‡ | ~80 MB | ~25 MB | **69%** â¬‡ï¸ |
| **æ€»è®¡** | **~115 MB** | **~33 MB** | **71%** â¬‡ï¸ |

åŠ è½½é€Ÿåº¦æå‡ï¼š**é¦–å±æ—¶é—´å‡å°‘ 60-70%**

---

## ğŸ“– è¯¦ç»†ä¼˜åŒ–æŒ‡å—

### ğŸš€ æ–¹æ¡ˆ 1ï¼šHTTP/2 Server Push

#### åŸç†

ä¼ ç»ŸåŠ è½½æµç¨‹éœ€è¦å¤šæ¬¡å¾€è¿”ï¼ˆRTTï¼‰ï¼š
```
æµè§ˆå™¨ â†’ è¯·æ±‚ HTML â†’ æœåŠ¡å™¨
æµè§ˆå™¨ â† è¿”å› HTML â† æœåŠ¡å™¨
æµè§ˆå™¨è§£æ HTMLï¼Œå‘ç°éœ€è¦ CSS
æµè§ˆå™¨ â†’ è¯·æ±‚ CSS â†’ æœåŠ¡å™¨
æµè§ˆå™¨ â† è¿”å› CSS â† æœåŠ¡å™¨
...ï¼ˆä¾æ¬¡åŠ è½½ JSã€JSONï¼‰
```

HTTP/2 Server Push ä¸€æ¬¡æ€§æ¨é€ï¼š
```
æµè§ˆå™¨ â†’ è¯·æ±‚ HTML â†’ æœåŠ¡å™¨
æµè§ˆå™¨ â† åŒæ—¶æ¨é€ HTML + CSS + JS + JSON â† æœåŠ¡å™¨
```

**èŠ‚çœæ—¶é—´**ï¼šå‡è®¾ç½‘ç»œå»¶è¿Ÿ 50msï¼Œä¼ ç»Ÿæ–¹å¼éœ€è¦ 10 æ¬¡å¾€è¿” = 500msï¼ŒServer Push åªéœ€ 1 æ¬¡ = 50msã€‚

#### å®æ–½æ­¥éª¤

##### âœ… æ­¥éª¤ 1ï¼šå·²åˆ›å»º `_headers` æ–‡ä»¶

æ–‡ä»¶ä½ç½®ï¼š`proj/_headers`

è¿™ä¸ªæ–‡ä»¶å·²ç»é…ç½®å¥½ï¼š
- âœ… HTTP/2 Server Pushï¼ˆé¢„åŠ è½½å…³é”®èµ„æºï¼‰
- âœ… DNS é¢„è¿æ¥ï¼ˆåŠ é€Ÿ R2 CDNï¼‰
- âœ… ç¼“å­˜ç­–ç•¥ï¼ˆåˆ†å±‚ç¼“å­˜ï¼‰

##### âœ… æ­¥éª¤ 2ï¼šéƒ¨ç½²åˆ° Cloudflare Pages

Cloudflare Pages ä¼šè‡ªåŠ¨è¯†åˆ« `_headers` æ–‡ä»¶ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚

**éƒ¨ç½²æ–¹æ³•**ï¼š

```bash
# æ–¹æ³• 1ï¼šé€šè¿‡ Git æ¨é€ï¼ˆæ¨èï¼‰
git add proj/_headers
git commit -m "feat: æ·»åŠ  HTTP/2 Server Push å’Œç¼“å­˜ä¼˜åŒ–"
git push origin main

# Cloudflare Pages ä¼šè‡ªåŠ¨éƒ¨ç½²
```

æˆ–è€…ï¼š

```bash
# æ–¹æ³• 2ï¼šä½¿ç”¨ä½ ç°æœ‰çš„éƒ¨ç½²è„šæœ¬
./deploy-to-vercel.sh  # å¦‚æœæ”¯æŒ
```

##### âœ… æ­¥éª¤ 3ï¼šéªŒè¯æ•ˆæœ

éƒ¨ç½²åï¼Œæ‰“å¼€ Chrome DevTools éªŒè¯ï¼š

1. **Network é¢æ¿**ï¼š
   ```
   - æŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·
   - åˆ‡æ¢åˆ° Network æ ‡ç­¾
   - å‹¾é€‰ "Disable cache"ï¼ˆç¦ç”¨ç¼“å­˜ï¼‰
   - åˆ·æ–°é¡µé¢ï¼ˆCtrl + Shift + Rï¼‰
   - æŸ¥çœ‹ "Initiator" åˆ—
   - å¦‚æœæ˜¾ç¤º "Push / Other"ï¼Œè¯´æ˜ Server Push ç”Ÿæ•ˆ
   ```

2. **æŸ¥çœ‹å“åº”å¤´**ï¼š
   ```
   - ç‚¹å‡» index.html è¯·æ±‚
   - æŸ¥çœ‹ Response Headers
   - åº”è¯¥çœ‹åˆ°ç±»ä¼¼ï¼š
     link: </css/styles.css>; rel=preload; as=style
     link: </src/config/r2-config.js>; rel=preload; as=script
   ```

3. **Performance é¢æ¿**ï¼ˆæ›´ç›´è§‚ï¼‰ï¼š
   ```
   - åˆ‡æ¢åˆ° Performance æ ‡ç­¾
   - ç‚¹å‡» "å½•åˆ¶" æŒ‰é’®
   - åˆ·æ–°é¡µé¢
   - åœæ­¢å½•åˆ¶
   - æŸ¥çœ‹ Network æ—¶é—´çº¿
   - Push çš„èµ„æºä¼šåœ¨ HTML ä¸‹è½½å®Œæˆå‰å°±å¼€å§‹ä¼ è¾“
   ```

#### é¢„æœŸæ•ˆæœ

| æŒ‡æ ‡ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æå‡ |
|------|--------|--------|------|
| é¦–å±æ—¶é—´ï¼ˆFCPï¼‰ | ~1.5s | ~0.5s | **67%** â¬‡ï¸ |
| å¯äº¤äº’æ—¶é—´ï¼ˆTTIï¼‰ | ~2.5s | ~1.0s | **60%** â¬‡ï¸ |
| èµ„æºåŠ è½½å®Œæˆ | ~3.0s | ~1.2s | **60%** â¬‡ï¸ |

**æ³¨æ„**ï¼šå®é™…æ•ˆæœå–å†³äºç½‘ç»œæ¡ä»¶ï¼Œç½‘ç»œè¶Šæ…¢ï¼Œæå‡è¶Šæ˜æ˜¾ã€‚

---

### ğŸ“¦ æ–¹æ¡ˆ 2ï¼šèµ„æºå‹ç¼©ä¼˜åŒ–

#### ğŸµ éŸ³é¢‘å‹ç¼©

##### å½“å‰çŠ¶æ€
- **æ–‡ä»¶æ•°é‡**ï¼š662 ä¸ª MP3 æ–‡ä»¶
- **åŸå§‹å¤§å°**ï¼šçº¦ 30-50 MBï¼ˆä¼°è®¡ï¼‰
- **é—®é¢˜**ï¼šå¯èƒ½ä½¿ç”¨é«˜æ¯”ç‰¹ç‡ï¼ˆ128 kbpsï¼‰ï¼Œå¯¹è¯­éŸ³å†…å®¹è¿‡åº¦

##### ä¼˜åŒ–ç›®æ ‡
- **ç›®æ ‡å¤§å°**ï¼š8-15 MB
- **èŠ‚çœç©ºé—´**ï¼š70-75%
- **éŸ³è´¨æŸå¤±**ï¼šå‡ ä¹æ— æŸï¼ˆè¯­éŸ³å†…å®¹ï¼‰

##### å®æ–½æ­¥éª¤

###### 1ï¸âƒ£ å®‰è£…ä¾èµ–

```bash
cd proj/tools

# å®‰è£… Node.js ä¾èµ–
npm init -y  # å¦‚æœè¿˜æ²¡æœ‰ package.json
npm install fluent-ffmpeg ffmpeg-static
```

###### 2ï¸âƒ£ è¿è¡Œå‹ç¼©è„šæœ¬

```bash
node compress-audio.js
```

è„šæœ¬ä¼šï¼š
- âœ… æ‰«æ `proj/audio/` ç›®å½•ä¸‹æ‰€æœ‰ MP3 æ–‡ä»¶
- âœ… æ‰¹é‡å‹ç¼©ï¼ˆå¹¶å‘ 4 ä¸ªçº¿ç¨‹ï¼‰
- âœ… è¾“å‡ºåˆ° `proj/audio-optimized/` ç›®å½•
- âœ… ä¿æŒåŸå§‹æ–‡ä»¶åå’Œç›®å½•ç»“æ„
- âœ… æ˜¾ç¤ºå‹ç¼©ç»Ÿè®¡ï¼ˆåŸå§‹å¤§å° â†’ å‹ç¼©åå¤§å° â†’ èŠ‚çœæ¯”ä¾‹ï¼‰

**å‹ç¼©å‚æ•°**ï¼ˆå¯åœ¨è„šæœ¬ä¸­è°ƒæ•´ï¼‰ï¼š
```javascript
audioBitrate: '32k',      // æ¯”ç‰¹ç‡ï¼š32 kbpsï¼ˆè¯­éŸ³è¶³å¤Ÿï¼‰
audioChannels: 1,         // å•å£°é“
audioFrequency: 22050,    // é‡‡æ ·ç‡ï¼š22050 Hz
```

**ç¤ºä¾‹è¾“å‡º**ï¼š
```
ğŸµ éŸ³é¢‘æ‰¹é‡å‹ç¼©å·¥å…·

ğŸ“‚ è¾“å…¥ç›®å½•: D:/workspace/WordPractice/proj/audio
ğŸ“‚ è¾“å‡ºç›®å½•: D:/workspace/WordPractice/proj/audio-optimized
âš™ï¸  å‹ç¼©å‚æ•°:
   - æ¯”ç‰¹ç‡: 32k
   - é‡‡æ ·ç‡: 22050 Hz
   - å£°é“: å•å£°é“
   - å¹¶å‘æ•°: 4

ğŸ” æ‰«æéŸ³é¢‘æ–‡ä»¶...
âœ… æ‰¾åˆ° 662 ä¸ªéŸ³é¢‘æ–‡ä»¶

ğŸš€ å¼€å§‹æ‰¹é‡å‹ç¼©...

ğŸ”§ å¤„ç†: about_youdao.mp3
âœ… å®Œæˆ: about_youdao.mp3 (0.05MB â†’ 0.01MB, èŠ‚çœ 80%)

...

============================================================
ğŸ“Š å¤„ç†å®Œæˆï¼ç»Ÿè®¡ä¿¡æ¯ï¼š
============================================================
æ€»æ–‡ä»¶æ•°:   662
å¤„ç†æˆåŠŸ:   662
è·³è¿‡:       0
å¤±è´¥:       0
åŸå§‹å¤§å°:   33.12 MB
å‹ç¼©å:     8.45 MB
èŠ‚çœç©ºé—´:   24.67 MB (74.5%)
å¤„ç†æ—¶é—´:   45.3 ç§’
============================================================
```

###### 3ï¸âƒ£ è¯•å¬éªŒè¯

åœ¨ `proj/audio-optimized/` ç›®å½•ä¸­éšæœºè¯•å¬å‡ ä¸ªæ–‡ä»¶ï¼Œç¡®è®¤éŸ³è´¨æ»¡æ„ã€‚

æ¨èæµ‹è¯•ï¼š
- `hello_youdao.mp3`ï¼ˆç®€å•å•è¯ï¼‰
- `beautiful_youdao.mp3`ï¼ˆå¤æ‚å•è¯ï¼‰
- `answer the phone_youdao.mp3`ï¼ˆçŸ­è¯­ï¼‰

**å¦‚æœéŸ³è´¨ä¸æ»¡æ„**ï¼Œå¯ä»¥è°ƒæ•´å‚æ•°ï¼š
```javascript
// åœ¨ compress-audio.js ä¸­ä¿®æ”¹ï¼š
audioBitrate: '48k',  // æé«˜æ¯”ç‰¹ç‡ï¼ˆ32k â†’ 48kï¼‰
audioQuality: 3,      // æé«˜è´¨é‡ï¼ˆ5 â†’ 3ï¼Œæ•°å­—è¶Šå°è´¨é‡è¶Šé«˜ï¼‰
```

###### 4ï¸âƒ£ æ›¿æ¢åŸæ–‡ä»¶

å¦‚æœæ»¡æ„ï¼Œå¤‡ä»½åŸæ–‡ä»¶å¹¶æ›¿æ¢ï¼š

```bash
# å¤‡ä»½åŸæ–‡ä»¶
mv proj/audio proj/audio-backup

# æ›¿æ¢ä¸ºå‹ç¼©åçš„æ–‡ä»¶
mv proj/audio-optimized proj/audio
```

**é‡è¦**ï¼šä¿ç•™ `audio-backup`ï¼Œä»¥é˜²éœ€è¦å›æ»šã€‚

---

#### ğŸ–¼ï¸ å›¾ç‰‡å‹ç¼©

##### å½“å‰çŠ¶æ€
- **æ–‡ä»¶æ•°é‡**ï¼š608 ä¸ª JPG/JPEG æ–‡ä»¶
- **åŸå§‹å¤§å°**ï¼šçº¦ 50-100 MBï¼ˆä¼°è®¡ï¼‰
- **é—®é¢˜**ï¼šå¯èƒ½å°ºå¯¸è¿‡å¤§ï¼ˆ>1000pxï¼‰ï¼Œæœªä½¿ç”¨ç°ä»£æ ¼å¼ï¼ˆWebPï¼‰

##### ä¼˜åŒ–ç›®æ ‡
- **ç›®æ ‡å¤§å°**ï¼š15-30 MB
- **èŠ‚çœç©ºé—´**ï¼š50-70%
- **è§†è§‰è´¨é‡**ï¼šå‡ ä¹æ— æŸ

##### å®æ–½æ­¥éª¤

###### 1ï¸âƒ£ å®‰è£…ä¾èµ–

```bash
cd proj/tools

# å®‰è£… Sharpï¼ˆé«˜æ€§èƒ½å›¾ç‰‡å¤„ç†åº“ï¼‰
npm install sharp
```

###### 2ï¸âƒ£ è¿è¡Œå‹ç¼©è„šæœ¬

```bash
node compress-images.js
```

è„šæœ¬ä¼šï¼š
- âœ… æ‰«æ `proj/images/cache/` ç›®å½•ä¸‹æ‰€æœ‰å›¾ç‰‡
- âœ… æ‰¹é‡å‹ç¼©ï¼ˆå¹¶å‘ 8 ä¸ªçº¿ç¨‹ï¼‰
- âœ… è½¬æ¢ä¸º WebP æ ¼å¼ï¼ˆå¯é€‰ï¼‰
- âœ… è°ƒæ•´å°ºå¯¸ï¼ˆæœ€å¤§ 800x800pxï¼‰
- âœ… è¾“å‡ºåˆ° `proj/images-optimized/` ç›®å½•

**å‹ç¼©å‚æ•°**ï¼ˆå¯åœ¨è„šæœ¬ä¸­è°ƒæ•´ï¼‰ï¼š
```javascript
format: 'webp',         // è¾“å‡ºæ ¼å¼ï¼šwebpï¼ˆæ¨èï¼‰/ jpeg / png
quality: 80,            // è´¨é‡ï¼š80ï¼ˆWebPï¼‰ï¼Œ85ï¼ˆJPEGï¼‰
maxWidth: 800,          // æœ€å¤§å®½åº¦ï¼ˆä¿æŒæ¯”ä¾‹ï¼‰
maxHeight: 800,         // æœ€å¤§é«˜åº¦
keepOriginalFormat: false, // true = ä¿æŒåŸæ ¼å¼ï¼Œfalse = è½¬æ¢ä¸º WebP
```

**WebP çš„ä¼˜åŠ¿**ï¼š
- æ¯” JPEG å° 25-35%
- æ¯” PNG å° 50-70%
- æ”¯æŒé€æ˜åº¦
- æµè§ˆå™¨æ”¯æŒç‡ >95%ï¼ˆChromeã€Firefoxã€Edgeã€Safari 14+ï¼‰

###### 3ï¸âƒ£ æŸ¥çœ‹æ•ˆæœ

éšæœºæ‰“å¼€å‡ ä¸ªå‹ç¼©åçš„å›¾ç‰‡ï¼Œç¡®è®¤è´¨é‡æ»¡æ„ã€‚

**å¦‚æœå›¾ç‰‡è´¨é‡ä¸æ»¡æ„**ï¼Œå¯ä»¥æé«˜è´¨é‡å‚æ•°ï¼š
```javascript
quality: 85,  // æé«˜è´¨é‡ï¼ˆ80 â†’ 85ï¼‰
```

###### 4ï¸âƒ£ ä¿®æ”¹ä»£ç ï¼ˆå¦‚æœè½¬æ¢ä¸º WebPï¼‰

å¦‚æœé€‰æ‹©è½¬æ¢ä¸º WebPï¼Œéœ€è¦ä¿®æ”¹æ¸¸æˆä»£ç ä¸­çš„å›¾ç‰‡è·¯å¾„ï¼š

**ä¿®æ”¹ `proj/src/core/WordTetrisGame.js`**ï¼š

æ‰¾åˆ° `updateImageShowcase` æ–¹æ³•ï¼ˆçº¦ 2905 è¡Œï¼‰ï¼š

```javascript
// åŸä»£ç ï¼š
const localJpg = getImageUrl(`cache/${word}.jpeg`);
this.tryLoadImage(img, localJpg, 'æœ¬åœ°JPEG', () => {
  const localJpeg = getImageUrl(`cache/${word}.jpg`);
  this.tryLoadImage(img, localJpeg, 'æœ¬åœ°JPG', () => {
    const localPng = getImageUrl(`cache/${word}.png`);
    // ...
  });
});

// ä¿®æ”¹ä¸ºï¼ˆä¼˜å…ˆåŠ è½½ WebPï¼‰ï¼š
const localWebp = getImageUrl(`cache/${word}.webp`);
this.tryLoadImage(img, localWebp, 'æœ¬åœ°WebP', () => {
  const localJpg = getImageUrl(`cache/${word}.jpeg`);
  this.tryLoadImage(img, localJpg, 'æœ¬åœ°JPEG', () => {
    // ... ä¿ç•™åŸæœ‰çš„å›é€€é€»è¾‘
  });
});
```

**æˆ–è€…**ï¼šä¿æŒåŸæ ¼å¼ï¼ˆä¸è½¬æ¢ä¸º WebPï¼‰ï¼Œåœ¨è„šæœ¬ä¸­è®¾ç½®ï¼š
```javascript
keepOriginalFormat: true,  // ä¿æŒåŸæ ¼å¼ï¼ˆJPEG/PNGï¼‰
```

###### 5ï¸âƒ£ æ›¿æ¢åŸæ–‡ä»¶

```bash
# å¤‡ä»½åŸæ–‡ä»¶
mv proj/images/cache proj/images/cache-backup

# æ›¿æ¢ä¸ºå‹ç¼©åçš„æ–‡ä»¶
mv proj/images-optimized/cache proj/images/cache
```

---

## ğŸ¯ å®Œæ•´ä¼˜åŒ–æµç¨‹

### æ¨èæ‰§è¡Œé¡ºåº

```bash
# 1. åˆ›å»º _headers æ–‡ä»¶ï¼ˆå·²å®Œæˆï¼‰
# æ–‡ä»¶ï¼šproj/_headers

# 2. å‹ç¼©éŸ³é¢‘æ–‡ä»¶
cd proj/tools
npm install fluent-ffmpeg ffmpeg-static
node compress-audio.js
# è¯•å¬éªŒè¯
# å¦‚æœæ»¡æ„ï¼Œæ›¿æ¢åŸæ–‡ä»¶

# 3. å‹ç¼©å›¾ç‰‡æ–‡ä»¶
npm install sharp
node compress-images.js
# æŸ¥çœ‹éªŒè¯
# å¦‚æœæ»¡æ„ï¼Œæ›¿æ¢åŸæ–‡ä»¶å¹¶ä¿®æ”¹ä»£ç ï¼ˆå¦‚æœè½¬ WebPï¼‰

# 4. æäº¤ä»£ç 
cd ../..
git add proj/_headers proj/audio proj/images
git commit -m "perf: ä¼˜åŒ–èµ„æºåŠ è½½å’Œå‹ç¼©ï¼ˆHTTP/2 Push + éŸ³é¢‘/å›¾ç‰‡å‹ç¼©ï¼‰"
git push origin main

# 5. ä¸Šä¼ åˆ° R2ï¼ˆå¦‚æœä½¿ç”¨ R2 CDNï¼‰
# ä½¿ç”¨ Cloudflare Dashboard æˆ– Wrangler CLI ä¸Šä¼ å‹ç¼©åçš„éŸ³é¢‘å’Œå›¾ç‰‡

# 6. éƒ¨ç½²åˆ° Cloudflare Pages
# è‡ªåŠ¨éƒ¨ç½²ï¼ˆå¦‚æœç»‘å®šäº† GitHubï¼‰
# æˆ–æ‰‹åŠ¨éƒ¨ç½²

# 7. éªŒè¯æ•ˆæœ
# æ‰“å¼€ https://wordpractice.pages.dev/
# æŒ‰ F12 â†’ Network é¢æ¿
# æ¸…é™¤ç¼“å­˜ï¼ˆCtrl + Shift + Deleteï¼‰
# åˆ·æ–°é¡µé¢ï¼ˆCtrl + Shift + Rï¼‰
# æŸ¥çœ‹åŠ è½½æ—¶é—´å’Œèµ„æºå¤§å°
```

---

## ğŸ“Š ä¼˜åŒ–æ•ˆæœå¯¹æ¯”

### åŠ è½½é€Ÿåº¦

| æŒ‡æ ‡ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æå‡ |
|------|--------|--------|------|
| é¦–å±æ—¶é—´ï¼ˆFCPï¼‰ | ~2.0s | ~0.6s | **70%** â¬‡ï¸ |
| å¯äº¤äº’æ—¶é—´ï¼ˆTTIï¼‰ | ~3.5s | ~1.2s | **66%** â¬‡ï¸ |
| å®Œå…¨åŠ è½½ | ~5.0s | ~2.0s | **60%** â¬‡ï¸ |

### èµ„æºå¤§å°

| èµ„æºç±»å‹ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | èŠ‚çœ |
|---------|--------|--------|------|
| éŸ³é¢‘ï¼ˆ662 æ–‡ä»¶ï¼‰ | ~35 MB | ~8 MB | **77%** â¬‡ï¸ |
| å›¾ç‰‡ï¼ˆ608 æ–‡ä»¶ï¼‰ | ~80 MB | ~25 MB | **69%** â¬‡ï¸ |
| **æ€»è®¡** | **~115 MB** | **~33 MB** | **71%** â¬‡ï¸ |

### ç”¨æˆ·ä½“éªŒ

- âœ… **å¿«é€Ÿç”µè„‘**ï¼šé¦–æ¬¡è®¿é—®ä» 3s é™è‡³ 1s
- âœ… **æ…¢é€Ÿç”µè„‘**ï¼šé¦–æ¬¡è®¿é—®ä» 8s é™è‡³ 2.5s
- âœ… **ç§»åŠ¨è®¾å¤‡**ï¼šæµé‡æ¶ˆè€—å‡å°‘ 70%
- âœ… **é‡å¤è®¿é—®**ï¼šåˆ©ç”¨ç¼“å­˜ï¼Œå‡ ä¹ç§’å¼€

---

## ğŸ” æ€§èƒ½ç›‘æ§

### ä½¿ç”¨ Lighthouse æµ‹è¯•

```bash
# å®‰è£… Lighthouse CLIï¼ˆå¯é€‰ï¼‰
npm install -g lighthouse

# è¿è¡Œæµ‹è¯•
lighthouse https://wordpractice.pages.dev/ --view
```

**æˆ–è€…**ï¼šåœ¨ Chrome DevTools ä¸­ä½¿ç”¨ Lighthouseï¼š
1. æŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·
2. åˆ‡æ¢åˆ° "Lighthouse" æ ‡ç­¾
3. é€‰æ‹© "Performance" + "Best practices"
4. ç‚¹å‡» "Analyze page load"

**ç›®æ ‡åˆ†æ•°**ï¼š
- Performance: 90+ï¼ˆä¼˜åŒ–å‰å¯èƒ½ 60-70ï¼‰
- Best Practices: 95+

---

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### é—®é¢˜ 1ï¼šéŸ³é¢‘å‹ç¼©åæ— å£°éŸ³

**åŸå› **ï¼šFFmpeg æœªæ­£ç¡®å®‰è£…æˆ–è·¯å¾„é”™è¯¯

**è§£å†³**ï¼š
```bash
# æ£€æŸ¥ FFmpeg æ˜¯å¦å®‰è£…
ffmpeg -version

# å¦‚æœæœªå®‰è£…ï¼Œé€šè¿‡ ffmpeg-static å®‰è£…
npm install ffmpeg-static

# æˆ–æ‰‹åŠ¨ä¸‹è½½ FFmpegï¼š
# Windows: https://www.gyan.dev/ffmpeg/builds/
# å°† ffmpeg.exe æ·»åŠ åˆ°ç³»ç»Ÿ PATH
```

### é—®é¢˜ 2ï¼šå›¾ç‰‡å‹ç¼©åæ¨¡ç³Š

**åŸå› **ï¼šè´¨é‡å‚æ•°è¿‡ä½

**è§£å†³**ï¼šåœ¨ `compress-images.js` ä¸­æé«˜è´¨é‡ï¼š
```javascript
quality: 85,  // ä» 80 æé«˜åˆ° 85
```

### é—®é¢˜ 3ï¼šServer Push æœªç”Ÿæ•ˆ

**åŸå› **ï¼šæµè§ˆå™¨ä¸æ”¯æŒæˆ–ç¼“å­˜é—®é¢˜

**è§£å†³**ï¼š
1. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜ï¼ˆCtrl + Shift + Deleteï¼‰
2. ç¡¬åˆ·æ–°ï¼ˆCtrl + Shift + Rï¼‰
3. æ£€æŸ¥å“åº”å¤´æ˜¯å¦åŒ…å« `Link:` å¤´
4. ç¡®è®¤ Cloudflare Pages å·²éƒ¨ç½²æœ€æ–°ç‰ˆæœ¬

### é—®é¢˜ 4ï¼šWebP å›¾ç‰‡ä¸æ˜¾ç¤º

**åŸå› **ï¼šæ—§ç‰ˆ Safari ä¸æ”¯æŒ WebP

**è§£å†³**ï¼š
1. **æ–¹æ¡ˆ A**ï¼šä¿æŒåŸæ ¼å¼ï¼ˆ`keepOriginalFormat: true`ï¼‰
2. **æ–¹æ¡ˆ B**ï¼šæ·»åŠ å›é€€é€»è¾‘ï¼ˆä»£ç å·²åŒ…å«ï¼‰
3. **æ–¹æ¡ˆ C**ï¼šä½¿ç”¨ `<picture>` æ ‡ç­¾ï¼š
   ```html
   <picture>
     <source srcset="image.webp" type="image/webp">
     <img src="image.jpg" alt="...">
   </picture>
   ```

---

## ğŸ’¡ è¿›é˜¶ä¼˜åŒ–å»ºè®®

### 1. Service Worker ç¼“å­˜

åˆ›å»º Service Worker é¢„ç¼“å­˜å¸¸ç”¨èµ„æºï¼š

```javascript
// sw.js
const CACHE_NAME = 'word-tetris-v1';
const urlsToCache = [
  '/',
  '/css/styles.css',
  '/src/core/WordTetrisGame.js',
  '/words/vocabulary-config.json',
  // å¸¸ç”¨å•è¯çš„éŸ³é¢‘å’Œå›¾ç‰‡
  '/audio/hello_youdao.mp3',
  '/images/cache/hello.webp',
];

self.addEventListener('install', (event) => {
  event.waitUntil(
    caches.open(CACHE_NAME).then((cache) => cache.addAll(urlsToCache))
  );
});
```

### 2. æ‡’åŠ è½½

å¯¹éå…³é”®èµ„æºï¼ˆå¦‚é”™è¯æœ¬ï¼‰ä½¿ç”¨æ‡’åŠ è½½ï¼š

```javascript
// å»¶è¿ŸåŠ è½½é”™è¯ç®¡ç†å™¨
setTimeout(() => {
  import('./utils/MissedWordsManager.js');
}, 2000);
```

### 3. å›¾ç‰‡æ‡’åŠ è½½

ä½¿ç”¨ `loading="lazy"` å±æ€§ï¼š

```html
<img src="image.webp" loading="lazy" alt="...">
```

### 4. é¢„è¿æ¥ç¬¬ä¸‰æ–¹åŸŸå

åœ¨ HTML ä¸­æ·»åŠ ï¼š

```html
<link rel="preconnect" href="https://loremflickr.com">
<link rel="preconnect" href="https://picsum.photos">
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. Node.js ç‰ˆæœ¬æ˜¯å¦ >= 14
2. FFmpeg æ˜¯å¦æ­£ç¡®å®‰è£…
3. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
4. æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®

ç¥ä¼˜åŒ–é¡ºåˆ©ï¼ğŸš€
