<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤šå­—æ¯è¾“å…¥ä¿®å¤éªŒè¯?/title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .button:hover {
            background: #2980b9;
        }
        .test-word {
            font-size: 2.5em;
            font-weight: bold;
            text-align: center;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 5px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            border: 2px solid #ddd;
        }
        .input-section {
            text-align: center;
            margin: 20px 0;
        }
        .input-section input {
            font-size: 1.8em;
            padding: 15px;
            border: 3px solid #3498db;
            border-radius: 8px;
            text-align: center;
            width: 300px;
            font-family: 'Courier New', monospace;
        }
        .step-by-step {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .step {
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            background: #f8f9fa;
            text-align: center;
        }
        .step.current {
            border-color: #3498db;
            background: #e3f2fd;
        }
        .step.correct {
            border-color: #27ae60;
            background: #d5f4e6;
        }
        .step.error {
            border-color: #e74c3c;
            background: #fdeaea;
        }
        .step-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        .step-display {
            font-family: 'Courier New', monospace;
            font-size: 1.5em;
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 5px;
        }
        .expected {
            color: #27ae60;
            font-weight: bold;
        }
        .actual {
            color: #3498db;
            font-weight: bold;
        }
        .debug-info {
            background: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            margin: 10px 0;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”¤ å¤šå­—æ¯è¾“å…¥ä¿®å¤éªŒè¯?/h1>
        <p>è¯¦ç»†æµ‹è¯•å¤šå­—æ¯ç¼ºå¤±æ—¶çš„è¾“å…¥æ˜¾ç¤ºé€»è¾‘</p>
        
        <div class="test-section">
            <h3>å½“å‰æµ‹è¯•ï¼šHELLOç¼ºå¤±Eå’ŒO</h3>
            <div class="test-word" id="current-word">H_LL_</div>
            <div class="input-section">
                <label><strong>è¾“å…¥ç¼ºå¤±å­—æ¯ï¼?/strong></label><br><br>
                <input type="text" id="test-input" maxlength="2" placeholder="è¾“å…¥EO">
            </div>
            <div class="test-word" id="display-result">H_LL_</div>
        </div>
        
        <div class="test-section">
            <h3>é€æ­¥éªŒè¯</h3>
            <div class="step-by-step" id="step-container">
                <!-- åŠ¨æ€ç”Ÿæˆæ­¥éª?-->
            </div>
        </div>
        
        <div class="test-section">
            <h3>è°ƒè¯•ä¿¡æ¯</h3>
            <div class="debug-info" id="debug-info">ç­‰å¾…è¾“å…¥...</div>
        </div>
        
        <div class="test-section">
            <h3>æµ‹è¯•å…¶ä»–å•è¯</h3>
            <button class="button" onclick="loadTestCase('HELLO', [1, 4], 'EO')">HELLO (ç¼ºå¤±E,O)</button>
            <button class="button" onclick="loadTestCase('WORLD', [1, 3], 'OL')">WORLD (ç¼ºå¤±O,L)</button>
            <button class="button" onclick="loadTestCase('SCHOOL', [0, 3, 5], 'SOL')">SCHOOL (ç¼ºå¤±S,O,L)</button>
            <button class="button" onclick="loadTestCase('FRIEND', [2, 4], 'IE')">FRIEND (ç¼ºå¤±I,E)</button>
        </div>
    </div>

    <script>
        let currentTestWord = null;
        
        // æ¨¡æ‹Ÿå•è¯å¯¹è±¡ç»“æ„
        function createTestWord(original, missingIndices, expectedInput) {
            const missingLetters = missingIndices.map(i => original[i]).join('');
            let display = original.split('');
            missingIndices.forEach(i => display[i] = '_');
            
            return {
                original: original,
                missing: missingIndices,
                missingLetters: missingLetters,
                display: display.join(''),
                expectedInput: expectedInput,
                realTimeDisplay: display.join(''),
                inputCorrect: true
            };
        }
        
        // æ¨¡æ‹Ÿä¿®å¤åçš„updateRealTimeDisplayé€»è¾‘
        function updateRealTimeDisplay(word, currentInput) {
            if (!word || currentInput.length === 0) {
                return word.display;
            }
            
            const expectedLetters = word.missingLetters.toUpperCase();
            
            // ä½¿ç”¨æ˜¾ç¤ºå•è¯ï¼ˆåŒ…å«ä¸‹åˆ’çº¿ï¼‰ä½œä¸ºåŸºç¡€
            let displayChars = word.display.split('');
            let inputIndex = 0;
            
            // åªæ›¿æ¢å·²è¾“å…¥å­—æ¯å¯¹åº”çš„ç¼ºå¤±ä½ç½?
            for (let i = 0; i < word.missing.length && inputIndex < currentInput.length; i++) {
                const missingIndex = word.missing[i];
                // æ›¿æ¢ä¸‹åˆ’çº¿ä¸ºå¸¦æ‹¬å·çš„è¾“å…¥å­—æ¯
                displayChars[missingIndex] = `[${currentInput[inputIndex]}]`;
                inputIndex++;
            }
            
            // å°†å­—ç¬¦æ•°ç»„é‡æ–°ç»„åˆæˆå­—ç¬¦ä¸?
            return displayChars.join('');
        }
        
        function loadTestCase(original, missingIndices, expectedInput) {
            currentTestWord = createTestWord(original, missingIndices, expectedInput);
            
            document.getElementById('current-word').textContent = currentTestWord.display;
            document.getElementById('display-result').textContent = currentTestWord.display;
            document.getElementById('test-input').value = '';
            document.getElementById('test-input').setAttribute('maxlength', expectedInput.length);
            document.getElementById('test-input').setAttribute('placeholder', `è¾“å…¥${expectedInput}`);
            
            updateSteps();
            updateDebugInfo('');
            
            console.log('åŠ è½½æµ‹è¯•ç”¨ä¾‹:', currentTestWord);
        }
        
        function updateSteps() {
            if (!currentTestWord) return;
            
            const container = document.getElementById('step-container');
            const expectedInput = currentTestWord.expectedInput;
            let stepsHtml = '';
            
            // ç”Ÿæˆæ¯ä¸€æ­¥çš„æœŸæœ›ç»“æœ
            for (let i = 0; i <= expectedInput.length; i++) {
                const input = expectedInput.substring(0, i);
                const expected = updateRealTimeDisplay(currentTestWord, input);
                
                stepsHtml += `
                    <div class="step" id="step-${i}">
                        <div class="step-title">æ­¥éª¤ ${i}: è¾“å…¥"${input}"</div>
                        <div class="step-display expected">æœŸæœ›: ${expected}</div>
                        <div class="step-display actual" id="actual-${i}">å®é™…: ç­‰å¾…è¾“å…¥</div>
                    </div>
                `;
            }
            
            container.innerHTML = stepsHtml;
        }
        
        function updateDebugInfo(input) {
            if (!currentTestWord) return;
            
            const debugInfo = `æµ‹è¯•å•è¯ä¿¡æ¯:
åŸå§‹å•è¯: ${currentTestWord.original}
æ˜¾ç¤ºå•è¯: ${currentTestWord.display}
ç¼ºå¤±ä½ç½®: [${currentTestWord.missing.join(', ')}]
ç¼ºå¤±å­—æ¯: ${currentTestWord.missingLetters}
æœŸæœ›è¾“å…¥: ${currentTestWord.expectedInput}

å½“å‰è¾“å…¥: "${input}"
è¾“å…¥é•¿åº¦: ${input.length}

å¤„ç†è¿‡ç¨‹:
1. åŸºç¡€æ˜¾ç¤º: ${currentTestWord.display}
2. å­—ç¬¦æ•°ç»„: [${currentTestWord.display.split('').map(c => `'${c}'`).join(', ')}]
3. æ›¿æ¢é€»è¾‘: 
${currentTestWord.missing.map((pos, i) => {
    if (i < input.length) {
        return `   ä½ç½®${pos}: '_' â†?'[${input[i]}]'`;
    } else {
        return `   ä½ç½®${pos}: '_' (ä¿æŒä¸å˜)`;
    }
}).join('\n')}
4. æœ€ç»ˆç»“æ? ${updateRealTimeDisplay(currentTestWord, input)}`;
            
            document.getElementById('debug-info').textContent = debugInfo;
        }
        
        // ç›‘å¬è¾“å…¥å˜åŒ–
        document.getElementById('test-input').addEventListener('input', function(e) {
            const input = e.target.value.toUpperCase();
            e.target.value = input; // ç¡®ä¿æ˜¾ç¤ºå¤§å†™
            
            if (currentTestWord) {
                const result = updateRealTimeDisplay(currentTestWord, input);
                document.getElementById('display-result').textContent = result;
                
                // æ›´æ–°æ­¥éª¤æ˜¾ç¤º
                for (let i = 0; i <= currentTestWord.expectedInput.length; i++) {
                    const stepElement = document.getElementById(`step-${i}`);
                    const actualElement = document.getElementById(`actual-${i}`);
                    
                    if (i === input.length) {
                        stepElement.className = 'step current';
                        actualElement.textContent = `å®é™…: ${result}`;
                        actualElement.className = 'step-display actual';
                        
                        // æ£€æŸ¥æ˜¯å¦æ­£ç¡?
                        const expected = updateRealTimeDisplay(currentTestWord, currentTestWord.expectedInput.substring(0, i));
                        if (result === expected) {
                            stepElement.className = 'step correct';
                        } else {
                            stepElement.className = 'step error';
                        }
                    } else if (i < input.length) {
                        const partialInput = currentTestWord.expectedInput.substring(0, i);
                        const partialResult = updateRealTimeDisplay(currentTestWord, partialInput);
                        actualElement.textContent = `å®é™…: ${partialResult}`;
                        
                        const expected = updateRealTimeDisplay(currentTestWord, partialInput);
                        stepElement.className = partialResult === expected ? 'step correct' : 'step error';
                    } else {
                        stepElement.className = 'step';
                        actualElement.textContent = 'å®é™…: ç­‰å¾…è¾“å…¥';
                        actualElement.className = 'step-display actual';
                    }
                }
                
                updateDebugInfo(input);
                console.log(`è¾“å…¥: "${input}" -> æ˜¾ç¤º: "${result}"`);
            }
        });
        
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.addEventListener('load', () => {
            loadTestCase('HELLO', [1, 4], 'EO');
        });
    </script>
</body>
</html>

