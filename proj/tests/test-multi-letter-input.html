<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤šå­—æ¯è¾“å…¥æ˜¾ç¤ºæµ‹è¯?/title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .button:hover {
            background: #2980b9;
        }
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        .test-word {
            font-size: 2em;
            font-weight: bold;
            text-align: center;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 5px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
        }
        .input-section {
            text-align: center;
            margin: 20px 0;
        }
        .input-section input {
            font-size: 1.5em;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            text-align: center;
            width: 200px;
        }
        .test-cases {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
        }
        .test-case {
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            background: #f8f9fa;
        }
        .test-case h4 {
            margin: 0 0 10px 0;
            color: #2c3e50;
        }
        .expected, .actual {
            font-family: 'Courier New', monospace;
            font-size: 1.2em;
            margin: 5px 0;
        }
        .expected {
            color: #27ae60;
        }
        .actual {
            color: #3498db;
        }
        .result {
            font-weight: bold;
            margin-top: 10px;
        }
        .result.pass {
            color: #27ae60;
        }
        .result.fail {
            color: #e74c3c;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”¤ å¤šå­—æ¯è¾“å…¥æ˜¾ç¤ºæµ‹è¯?/h1>
        <p>æµ‹è¯•å½“å•è¯æœ‰å¤šä¸ªç¼ºå¤±å­—æ¯æ—¶ï¼Œè¾“å…¥æ˜¾ç¤ºæ˜¯å¦æ­£ç¡®</p>
        
        <div class="test-section">
            <h3>å½“å‰æµ‹è¯•å•è¯</h3>
            <div class="test-word" id="current-word">H_LL_</div>
            <div class="input-section">
                <label>è¾“å…¥ç¼ºå¤±å­—æ¯ï¼?/label>
                <input type="text" id="test-input" maxlength="3" placeholder="è¾“å…¥å­—æ¯">
            </div>
            <div class="test-word" id="display-result">H_LL_</div>
        </div>
        
        <div class="test-section">
            <h3>æµ‹è¯•æ“ä½œ</h3>
            <button class="button" onclick="loadTestWord('HELLO', [1, 4])">æµ‹è¯• HELLO (ç¼ºå¤±E,O)</button>
            <button class="button" onclick="loadTestWord('WORLD', [1, 3])">æµ‹è¯• WORLD (ç¼ºå¤±O,L)</button>
            <button class="button" onclick="loadTestWord('SCHOOL', [0, 3, 5])">æµ‹è¯• SCHOOL (ç¼ºå¤±S,O,L)</button>
            <button class="button" onclick="clearInput()">æ¸…ç©ºè¾“å…¥</button>
        </div>
        
        <div class="test-section">
            <h3>è‡ªåŠ¨æµ‹è¯•ç”¨ä¾‹</h3>
            <button class="button" onclick="runAllTests()">è¿è¡Œæ‰€æœ‰æµ‹è¯?/button>
            <div id="test-results" class="test-cases"></div>
        </div>
        
        <div class="test-section">
            <h3>æµ‹è¯•è¯´æ˜</h3>
            <ul>
                <li><strong>æ­£ç¡®è¡Œä¸º</strong>ï¼šè¾“å…¥ç¬¬ä¸€ä¸ªå­—æ¯æ—¶ï¼Œåªæ˜¾ç¤ºç¬¬ä¸€ä¸ªç¼ºå¤±ä½ç½®çš„å­—æ¯ï¼Œå…¶ä»–ä½ç½®ä¿æŒä¸‹åˆ’çº¿</li>
                <li><strong>é”™è¯¯è¡Œä¸º</strong>ï¼šè¾“å…¥ç¬¬ä¸€ä¸ªå­—æ¯æ—¶ï¼Œæ‰€æœ‰ç¼ºå¤±ä½ç½®éƒ½æ˜¾ç¤ºå­—æ¯</li>
                <li><strong>ç¤ºä¾‹</strong>ï¼šHELLOç¼ºå¤±E,O â†?è¾“å…¥E â†?åº”æ˜¾ç¤ºH[E]LL_ï¼Œè€Œä¸æ˜¯H[E]LL[O]</li>
            </ul>
        </div>
    </div>

    <script src="../src/core/vocabulary-manager-v2.js"></script>
    <script>
        let currentTestWord = null;
        
        // æ¨¡æ‹Ÿæ¸¸æˆä¸­çš„å•è¯å¯¹è±¡ç»“æ„
        function createTestWord(original, missingIndices) {
            const missingLetters = missingIndices.map(i => original[i]).join('');
            let display = original.split('');
            missingIndices.forEach(i => display[i] = '_');
            
            return {
                original: original,
                missing: missingIndices,
                missingLetters: missingLetters,
                display: display.join(''),
                realTimeDisplay: display.join(''),
                inputCorrect: true
            };
        }
        
        // æ¨¡æ‹Ÿæ¸¸æˆä¸­çš„updateRealTimeDisplayé€»è¾‘
        function updateRealTimeDisplay(word, currentInput) {
            if (!word || currentInput.length === 0) {
                return word.display;
            }
            
            const expectedLetters = word.missingLetters.toUpperCase();
            
            // ä½¿ç”¨å­—ç¬¦æ•°ç»„æ¥é¿å…ç´¢å¼•é—®é¢?
            let displayChars = word.original.split('');
            let inputIndex = 0;
            
            // åªæ›¿æ¢å·²è¾“å…¥å­—æ¯å¯¹åº”çš„ç¼ºå¤±ä½ç½?
            for (let i = 0; i < word.missing.length && inputIndex < currentInput.length; i++) {
                const missingIndex = word.missing[i];
                // æ›¿æ¢ä¸ºå¸¦æ‹¬å·çš„è¾“å…¥å­—æ¯?
                displayChars[missingIndex] = `[${currentInput[inputIndex]}]`;
                inputIndex++;
            }
            
            // å°†å­—ç¬¦æ•°ç»„é‡æ–°ç»„åˆæˆå­—ç¬¦ä¸?
            return displayChars.join('');
        }
        
        function loadTestWord(original, missingIndices) {
            currentTestWord = createTestWord(original, missingIndices);
            
            document.getElementById('current-word').textContent = currentTestWord.display;
            document.getElementById('display-result').textContent = currentTestWord.display;
            document.getElementById('test-input').value = '';
            
            console.log('åŠ è½½æµ‹è¯•å•è¯:', currentTestWord);
        }
        
        function clearInput() {
            document.getElementById('test-input').value = '';
            if (currentTestWord) {
                document.getElementById('display-result').textContent = currentTestWord.display;
            }
        }
        
        // ç›‘å¬è¾“å…¥å˜åŒ–
        document.getElementById('test-input').addEventListener('input', function(e) {
            const input = e.target.value.toUpperCase();
            e.target.value = input; // ç¡®ä¿æ˜¾ç¤ºå¤§å†™
            
            if (currentTestWord) {
                const result = updateRealTimeDisplay(currentTestWord, input);
                document.getElementById('display-result').textContent = result;
                
                console.log(`è¾“å…¥: "${input}" -> æ˜¾ç¤º: "${result}"`);
            }
        });
        
        function runAllTests() {
            const testCases = [
                {
                    name: 'HELLOç¼ºå¤±E,O',
                    word: 'HELLO',
                    missing: [1, 4],
                    inputs: [
                        { input: 'E', expected: 'H[E]LL_' },
                        { input: 'EO', expected: 'H[E]LL[O]' }
                    ]
                },
                {
                    name: 'WORLDç¼ºå¤±O,L',
                    word: 'WORLD',
                    missing: [1, 3],
                    inputs: [
                        { input: 'O', expected: 'W[O]R_D' },
                        { input: 'OL', expected: 'W[O]R[L]D' }
                    ]
                },
                {
                    name: 'SCHOOLç¼ºå¤±S,O,L',
                    word: 'SCHOOL',
                    missing: [0, 3, 5],
                    inputs: [
                        { input: 'S', expected: '[S]CH_O_' },
                        { input: 'SO', expected: '[S]CH[O]O_' },
                        { input: 'SOL', expected: '[S]CH[O]O[L]' }
                    ]
                },
                {
                    name: 'CATç¼ºå¤±A',
                    word: 'CAT',
                    missing: [1],
                    inputs: [
                        { input: 'A', expected: 'C[A]T' }
                    ]
                }
            ];
            
            let resultsHtml = '';
            let totalTests = 0;
            let passedTests = 0;
            
            testCases.forEach(testCase => {
                const word = createTestWord(testCase.word, testCase.missing);
                
                testCase.inputs.forEach(test => {
                    totalTests++;
                    const actual = updateRealTimeDisplay(word, test.input);
                    const passed = actual === test.expected;
                    if (passed) passedTests++;
                    
                    resultsHtml += `
                        <div class="test-case">
                            <h4>${testCase.name} - è¾“å…¥"${test.input}"</h4>
                            <div class="expected">æœŸæœ›: ${test.expected}</div>
                            <div class="actual">å®é™…: ${actual}</div>
                            <div class="result ${passed ? 'pass' : 'fail'}">
                                ${passed ? 'âœ?é€šè¿‡' : 'â?å¤±è´¥'}
                            </div>
                        </div>
                    `;
                });
            });
            
            document.getElementById('test-results').innerHTML = `
                <div class="status ${passedTests === totalTests ? 'success' : 'error'}">
                    æµ‹è¯•ç»“æœ: ${passedTests}/${totalTests} é€šè¿‡ (${Math.round(passedTests/totalTests*100)}%)
                </div>
                ${resultsHtml}
            `;
        }
        
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.addEventListener('load', () => {
            loadTestWord('HELLO', [1, 4]);
        });
    </script>
</body>
</html>

