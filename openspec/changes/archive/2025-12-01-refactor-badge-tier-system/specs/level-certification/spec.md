## MODIFIED Requirements

### Requirement: 徽章系统

系统 SHALL 为每个大级别提供徽章奖励，采用欧洲古老家族徽章风格设计，共16枚徽章（12枚分级徽章 + 4枚段位徽章）。

#### Scenario: 徽章获得条件

- **GIVEN** 用户在某个大级别
- **WHEN** 用户通过该大级别的所有小级别
- **THEN** 系统 SHALL 授予该大级别徽章
- **AND** 显示徽章获得动画
- **AND** 徽章在考级页面悬挂区显示
- **AND** 系统检查并更新段位徽章点亮状态

#### Scenario: 徽章视觉状态

- **GIVEN** 考级页面显示徽章
- **WHEN** 徽章未获得
- **THEN** 徽章 SHALL 显示为灰色（未点亮）
- **WHEN** 徽章已获得
- **THEN** 徽章 SHALL 显示为彩色（点亮）

#### Scenario: 徽章设计风格

- **GIVEN** 系统需要显示徽章
- **THEN** 徽章 SHALL 采用欧洲古老家族徽章风格：
  - 盾形主体、丝带/橄榄枝装饰、金属浮雕质感
  - 青铜段位徽章：古铜色 + 青绿锈迹（新设计）
  - 白银段位徽章：银白色 + 珍珠光泽（新设计）
  - 黄金段位徽章：金色 + 琥珀暖调（新设计）
  - 王者段位徽章：紫金色 + 钻石光芒（新设计）
  - 原有12枚分级徽章：保留原有图案样式，仅调整边框/装饰色系以匹配所属段位

## ADDED Requirements

### Requirement: 段位系统

系统 SHALL 将徽章按青铜、白银、黄金、王者四个段位分组，每个段位有专属段位徽章。

#### Scenario: 段位分组结构

- **GIVEN** 用户进入徽章悬挂区
- **THEN** 系统 SHALL 按以下段位分组显示徽章：
  - 青铜：音标（1枚分级徽章）
  - 白银：3年级、4年级、5年级、6年级（4枚分级徽章）
  - 黄金：Fly Guy、神奇树屋、初中、高中（4枚分级徽章）
  - 王者：七龙珠、哈利波特、四级（3枚分级徽章）
- **AND** 每个段位组首位显示该段位的段位徽章

#### Scenario: 段位徽章点亮条件

- **GIVEN** 用户获得分级徽章
- **WHEN** 该段位内所有分级徽章全部点亮
- **THEN** 系统 SHALL 自动点亮该段位的段位徽章
- **AND** 显示段位徽章获得动画

#### Scenario: 青铜段位徽章点亮

- **GIVEN** 用户获得音标徽章
- **THEN** 青铜段位徽章 SHALL 自动点亮

#### Scenario: 白银段位徽章点亮

- **GIVEN** 用户已获得3年级、4年级、5年级、6年级徽章
- **THEN** 白银段位徽章 SHALL 自动点亮

#### Scenario: 黄金段位徽章点亮

- **GIVEN** 用户已获得 Fly Guy、神奇树屋、初中、高中徽章
- **THEN** 黄金段位徽章 SHALL 自动点亮

#### Scenario: 王者段位徽章点亮

- **GIVEN** 用户已获得七龙珠、哈利波特、四级徽章
- **THEN** 王者段位徽章 SHALL 自动点亮

#### Scenario: 段位不影响解锁逻辑

- **GIVEN** 考级系统的树状解锁机制
- **THEN** 段位分组 SHALL 仅影响徽章展示分组
- **AND** 不影响考试解锁顺序
- **AND** 原有树状解锁逻辑保持不变

### Requirement: 主游戏界面段位显示

系统 SHALL 在主游戏界面 header 右侧显示用户当前段位徽章，与左侧徽章区形成左右呼应，仅用于展示不支持点击。

#### Scenario: 段位显示位置

- **GIVEN** 用户进入主游戏界面
- **THEN** header 左侧 SHALL 显示徽章区
- **AND** header 中间 SHALL 显示标题 "Word Cannon WORD大炮 - 在游戏中学习英语"
- **AND** header 右侧 SHALL 显示当前段位徽章

#### Scenario: 显示当前最高段位徽章

- **GIVEN** 用户已点亮某些段位徽章
- **THEN** 段位显示区 SHALL 显示用户当前最高已点亮的段位徽章
- **AND** 徽章显示为彩色版本

#### Scenario: 无段位状态显示

- **GIVEN** 用户尚未点亮任何段位徽章
- **THEN** 段位显示区 SHALL 显示青铜段位徽章的暗色版本

#### Scenario: 段位徽章样式

- **WHEN** 当前最高段位为青铜
- **THEN** 显示青铜段位徽章彩色版本
- **WHEN** 当前最高段位为白银
- **THEN** 显示白银段位徽章彩色版本
- **WHEN** 当前最高段位为黄金
- **THEN** 显示黄金段位徽章彩色版本
- **WHEN** 当前最高段位为王者
- **THEN** 显示王者段位徽章彩色版本

#### Scenario: 段位徽章不可点击

- **GIVEN** 用户在主游戏界面
- **THEN** 段位徽章 SHALL 仅用于展示
- **AND** 不响应点击事件

## MODIFIED Requirements

### Requirement: 考级页面布局

系统 SHALL 提供专门的考级页面，采用游戏升级加点风格的 UI 设计，支持树状技能树展示。

#### Scenario: 徽章悬挂区

- **GIVEN** 用户进入考级页面
- **THEN** 页面顶部 SHALL 显示徽章悬挂区
- **AND** 按段位分区显示：青铜（🥉）、白银（🥈）、黄金（🥇）、王者（👑）
- **AND** 每个段位组首位显示段位徽章，后跟该段位的分级徽章
- **AND** 已获得徽章显示彩色，未获得显示灰色

#### Scenario: 技能树布局

- **GIVEN** 用户进入考级页面
- **THEN** 页面 SHALL 显示树状技能树：
  - 主干：音标 → 3年级 → 4年级 → 5年级 → 6年级
  - 分支1：6年级 → Fly Guy → 神奇树屋 → 七龙珠 → 哈利波特
  - 分支2：6年级 → 初中 → 高中 → 四级
- **AND** 节点之间用连接线表示解锁关系
- **AND** 分叉处清晰标识双分支

#### Scenario: 级别节点状态显示

- **GIVEN** 考级页面显示级别节点
- **WHEN** 级别已通过
- **THEN** 节点 SHALL 显示绿色勾选标记和分数
- **WHEN** 级别已解锁但未通过
- **THEN** 节点 SHALL 显示可点击状态
- **WHEN** 级别锁定
- **THEN** 节点 SHALL 显示锁定图标和灰色样式

### Requirement: 考级进度持久化

系统 SHALL 将考级进度保存到本地存储，确保刷新页面后进度不丢失。

#### Scenario: 保存进度

- **GIVEN** 用户完成一次考试
- **THEN** 系统 SHALL 自动保存以下信息到 localStorage：
  - 每个级别的通过状态
  - 每个级别的最高分数
  - 每个级别的尝试次数
  - 每个分级徽章的获得状态和时间
  - 每个段位徽章的获得状态和时间

#### Scenario: 恢复进度

- **GIVEN** 用户刷新页面或重新访问
- **WHEN** 进入考级系统
- **THEN** 系统 SHALL 从 localStorage 恢复所有考级进度
- **AND** 正确显示解锁状态和分数
- **AND** 正确显示段位徽章点亮状态

### Requirement: 测试模式支持

系统 SHALL 支持通过 URL 参数 `test=2` 开启测试模式，在荣誉殿堂中显示所有徽章为已获得状态。

#### Scenario: 测试模式开启所有徽章

- **WHEN** 用户访问带有 `?test=2` 参数的荣誉殿堂页面
- **THEN** 所有分级徽章显示为彩色已获得状态
- **AND** 所有段位徽章显示为彩色已获得状态
- **AND** 所有徽章显示亮星标记

