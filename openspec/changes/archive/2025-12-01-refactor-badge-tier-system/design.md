## Context

Word Tetris 考级系统需要更强的成就激励机制。当前徽章按"系列"分组，缺乏段位层级感。用户希望引入青铜/白银/黄金/王者段位概念，每个段位包含若干分级考试徽章，并有专属的段位徽章。

**约束**：
- 解锁逻辑保持不变（树状解锁机制）
- 段位仅影响展示分组和段位徽章点亮，不影响考试解锁
- 需保持欧洲古老家族徽章风格

## Goals / Non-Goals

**Goals:**
- 将12枚徽章重新分组为4个段位
- 为每个段位设计专属段位徽章（共4枚）
- 重新设计12枚原有徽章，融入段位色调
- 段位徽章在该段位所有分级徽章点亮后自动点亮

**Non-Goals:**
- 不改变考试解锁逻辑
- 不改变考试通过标准

## Decisions

### 1. 段位分组设计

| 段位 | 包含徽章 | 段位色调 | 设计理念 |
|------|---------|---------|---------|
| 青铜 | 音标 | 古铜色 + 青绿锈迹 | 入门起步，青涩但坚实 |
| 白银 | 3年级、4年级、5年级、6年级 | 银白色 + 珍珠光泽 | 稳步成长，打好基础 |
| 黄金 | Fly Guy、神奇树屋、初中、高中 | 金色 + 琥珀暖调 | 进阶挑战，实力提升 |
| 王者 | 七龙珠、哈利波特、四级 | 紫金色 + 钻石光芒 | 顶级成就，王者荣耀 |

### 2. 徽章视觉设计方案

**段位徽章设计（4枚新增）：**

```
┌─────────────────────────────────────────────────────────────────┐
│  青铜段位徽章                                                    │
│  ├─ 主色调：#CD7F32（古铜色）+ #4A7C59（青绿锈迹）              │
│  ├─ 形状：盾形，边缘有岁月侵蚀感                                │
│  ├─ 中心图案：音符或音标符号 /æ/                                │
│  └─ 装饰：简约橄榄枝，铜质浮雕纹理                              │
├─────────────────────────────────────────────────────────────────┤
│  白银段位徽章                                                    │
│  ├─ 主色调：#C0C0C0（银白）+ #E8E8E8（珍珠光泽）               │
│  ├─ 形状：盾形，边缘银质镶边                                    │
│  ├─ 中心图案：书本或学士帽                                      │
│  └─ 装饰：月桂枝环绕，银质浮雕纹理                              │
├─────────────────────────────────────────────────────────────────┤
│  黄金段位徽章                                                    │
│  ├─ 主色调：#FFD700（金色）+ #FFA500（琥珀暖调）               │
│  ├─ 形状：盾形，边缘金质镶边                                    │
│  ├─ 中心图案：展翅雄鹰或皇冠                                    │
│  └─ 装饰：橡树叶环绕，金质浮雕纹理，宝石点缀                    │
├─────────────────────────────────────────────────────────────────┤
│  王者段位徽章                                                    │
│  ├─ 主色调：#9B30FF（紫金）+ #FFD700（金色）+ 钻石光芒          │
│  ├─ 形状：皇冠形盾牌，边缘钻石镶嵌                              │
│  ├─ 中心图案：王冠 + 权杖交叉                                   │
│  └─ 装饰：丝带飘扬，钻石/宝石镶嵌，极致奢华                     │
└─────────────────────────────────────────────────────────────────┘
```

**原有12枚徽章色系调整（保留原有样式，仅调整色系）：**

| 徽章 | 所属段位 | 色系调整 |
|------|---------|---------|
| 音标 | 青铜 | 边框/装饰改为古铜色调，保留原有图案 |
| 3年级 | 白银 | 边框/装饰改为银白色调，保留原有图案 |
| 4年级 | 白银 | 边框/装饰改为银白色调，保留原有图案 |
| 5年级 | 白银 | 边框/装饰改为银白色调，保留原有图案 |
| 6年级 | 白银 | 边框/装饰改为银白色调，保留原有图案 |
| Fly Guy | 黄金 | 边框/装饰改为金色调，保留原有图案 |
| 神奇树屋 | 黄金 | 边框/装饰改为金色调，保留原有图案 |
| 初中 | 黄金 | 边框/装饰改为金色调，保留原有图案 |
| 高中 | 黄金 | 边框/装饰改为金色调，保留原有图案 |
| 七龙珠 | 王者 | 边框/装饰改为紫金色调，保留原有图案 |
| 哈利波特 | 王者 | 边框/装饰改为紫金色调，保留原有图案 |
| 四级 | 王者 | 边框/装饰改为紫金色调，保留原有图案 |

> 💡 **降低工作量**：仅调整徽章边框/装饰的色系，不改变原有图案和整体样式

### 3. 徽章悬挂区布局

```
┌─────────────────────────────────────────────────────────────────┐
│                    🏰 徽章悬挂区 🏰                              │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────────────────────────────────┐    │
│  │ 🥉 青铜                                                  │    │
│  │  [青铜段位徽章]  [音标]                                  │    │
│  └─────────────────────────────────────────────────────────┘    │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │ 🥈 白银                                                  │    │
│  │  [白银段位徽章]  [3年级] [4年级] [5年级] [6年级]         │    │
│  └─────────────────────────────────────────────────────────┘    │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │ 🥇 黄金                                                  │    │
│  │  [黄金段位徽章]  [Fly Guy] [神奇树屋] [初中] [高中]      │    │
│  └─────────────────────────────────────────────────────────┘    │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │ 👑 王者                                                  │    │
│  │  [王者段位徽章]  [七龙珠] [哈利波特] [四级]              │    │
│  └─────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────┘
```

### 4. 段位徽章点亮逻辑

```javascript
// 段位徽章点亮条件
const tierBadgeConditions = {
  bronze: ['phonics'],                                    // 音标通过 → 青铜点亮
  silver: ['grade3', 'grade4', 'grade5', 'grade6'],      // 3-6年级全通过 → 白银点亮
  gold: ['flyGuy', 'magicTreeHouse', 'middleSchool', 'highSchool'], // 4个全通过 → 黄金点亮
  king: ['dragonBall', 'harryPotter', 'cet4']            // 3个全通过 → 王者点亮
};

// 检查段位徽章是否点亮
function isTierBadgeEarned(tier, earnedBadges) {
  const required = tierBadgeConditions[tier];
  return required.every(badgeId => earnedBadges.includes(badgeId));
}
```

### 5. 数据结构变更

**新增段位徽章存储：**
```javascript
// localStorage 中新增字段
{
  "tierBadges": {
    "bronze": { "earned": true, "earnedAt": 1701388800000 },
    "silver": { "earned": false, "earnedAt": null },
    "gold": { "earned": false, "earnedAt": null },
    "king": { "earned": false, "earnedAt": null }
  }
}
```

### 6. 主游戏界面段位显示

在主游戏界面 header 右侧显示当前段位，与左侧徽章区形成呼应：

```
┌─────────────────────────────────────────────────────────────────┐
│  [徽章区]     Word Cannon  WORD大炮 - 在游戏中学习英语    [段位] │
│   🏅×3          （居中标题）                           🥈白银  │
└─────────────────────────────────────────────────────────────────┘
```

**段位显示规则：**
- 显示用户当前最高已点亮的段位徽章（彩色）
- 未点亮任何段位时显示青铜段位徽章的暗色版本
- 段位徽章仅用于展示，不支持点击

**段位显示样式：**
| 状态 | 显示内容 | 样式 |
|------|---------|------|
| 未点亮 | 青铜段位徽章 | 灰色/暗色版本 |
| 青铜 | 青铜段位徽章 | 彩色 #CD7F32 |
| 白银 | 白银段位徽章 | 彩色 #C0C0C0 |
| 黄金 | 黄金段位徽章 | 彩色 #FFD700 |
| 王者 | 王者段位徽章 | 彩色 #9B30FF |

## Risks / Trade-offs

| 风险 | 缓解措施 |
|------|---------|
| 徽章 SVG 设计工作量 | 原有12枚徽章仅调整色系，不改变样式；只需新设计4枚段位徽章 |
| 用户已有进度可能受影响 | 段位徽章根据已有分级徽章自动计算，无需迁移 |
| 徽章悬挂区布局变化较大 | 保持整体风格一致，渐进式更新 |

## Migration Plan

1. **Phase 1**: 更新徽章分组逻辑和 UI 布局（不更换徽章图片）
2. **Phase 2**: 设计并添加4枚段位徽章 SVG
3. **Phase 3**: 逐步更新12枚原有徽章的色调设计
4. **回滚**: 如需回滚，恢复原有分组逻辑即可，数据兼容

## Open Questions

- [ ] 段位徽章是否需要专属的获得动画？
- [ ] 主页徽章区是否也需要显示段位徽章？（当前方案：右侧段位显示区只显示当前最高段位）

